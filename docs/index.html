<!DOCTYPE html><html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="HomeGenie UI Progressive Web App.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HomeGenie UI</title>

    <!-- Disable tap highlight on IE -->
    <meta name="msapplication-tap-highlight" content="no">

    <!-- Progressive Web App -->
    <meta name="theme-color" content="white">
    <link rel="manifest" href="manifest.json">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" sizes="192x192" href="images/icons/desktop/android-chrome-192x192.png">
    <link rel="icon" sizes="512x512" href="images/icons/desktop/android-chrome-512x512.png">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="A zUIx website">
    <link rel="apple-touch-icon-precomposed" href="images/icons/desktop/apple-touch-icon.png">
    <link rel="mask-icon" href="images/icons/desktop/safari-pinned-tab.svg" color="#5bbad5">

    <!-- Tile color for Windows -->
    <meta name="msapplication-TileImage" content="images/icons/desktop/mstile-150x150.png">
    <meta name="msapplication-TileColor" content="#ffc40d">

    <!-- Place favicon.ico in the root directory -->
    <link rel="icon" type="image/png" sizes="32x32" href="images/icons/desktop/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="images/icons/desktop/favicon-16x16.png">

    <!-- SEO: If your mobile URL is different from the desktop URL, add a canonical link to the desktop page https://developers.google.com/webmasters/smartphone-sites/feature-phones -->
    <!--
    <link rel="canonical" href="http://www.example.com/">
    -->

    <!-- Lobster Font -->
    <style>
/*{% raw %}*/
@font-face {
  font-family: 'Lobster';
  font-style: normal;
  font-weight: 400;
  src: local('Lobster Regular'), local('Lobster-Regular'), url(https://fonts.gstatic.com/s/lobster/v22/neILzCirqoswsqX9zoKmNg.ttf) format('truetype');
}

/*{% endraw %}*/
</style>

    <!-- Material Design Icons -->
    <style>
/*{% raw %}*/
@font-face {
  font-family: 'Material Icons';
  font-style: normal;
  font-weight: 400;
  src: url(https://fonts.gstatic.com/s/materialicons/v48/flUhRq6tzZclQEJ-Vdg-IuiaDsNZ.ttf) format('truetype');
}

.material-icons {
  font-family: 'Material Icons';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
}

/*{% endraw %}*/
</style>

    <!-- import zUIx library -->
    <script src="js/zuix/zuix.js"></script>

    <!-- app config -->
    <script src="config.js"></script>

  <!-- HGUI -->
  <script>//{% raw %}
(function(window) {
    'use strict';
    zuix.ZxQuery.prototype.animateCss = function(a, b, c) {
        if (typeof b === 'function') b();
        else if (typeof c === 'function') c();
        return this;
    };
    function HGUI() {
        let adapters = [];
        let groups = [];
        let modules = [];
        let _configRevision;
        let currentGroup = 0;
        let listener;
        // Data persistence: PouchDB
        let db;
        const dbConfigurationId = 'hgui:configuration';
        zuix.using('script', 'js/pouchdb-7.0.0.min.js', ()=>{
            db = new PouchDB('hgui_data');
        });
        // hgui object
        const _hgui = {
            load: (callback) => {
                db.get(dbConfigurationId)
                .then((config) => {
                    if (config != null) {
                        _configRevision = config._rev;
                        groups = config.groups;
                        modules = [];
                        config.modules.map((m) => {
                            m = zuix.observable(m).proxy;
                            modules.push(m);
                            if (listener != null) listener.onModuleAdded(m);
                        });
                        groups.map((g) => {
                            if (listener != null) listener.onGroupAdded(g);
                            g.modules.map((mr) => {
                                if (listener != null) {
                                    listener.onGroupModuleAdded(g, modules.find((m) => m.id === mr.moduleId));
                                }
                            });
                        });
                    }
                    // Connect adapters
                    config.adapters.map((ac) => {
                        _hgui.showLoader();
                        _hgui.getAdapter(ac.adapterId, ac.componentId, (adapter) => {
                            adapter.options().config = ac.config;
                            adapter.connect(()=>{
                                // TODO: implement and handle connection errors
                                _hgui.hideLoader();
                            });
                            if (listener != null) {
                                listener.onAdapterAdded(adapter);
                            }
                        });
                    });
                    callback(config);
                }).catch((err) => {
                    callback(null, err);
                });
            },
            save: () => {
                const adaptersConfig = [];
                adapters.map((adapter) => {
                    const ac = {
                        adapterId: adapter.id(),
                        componentId: adapter.componentId,
                        config: adapter.options().config
                    };
                    adaptersConfig.push(ac);
                });
                const config = {
                    _id: dbConfigurationId,
                    _rev: _configRevision,
                    groups: groups,
                    modules: modules,
                    adapters: adaptersConfig,
                    timestamp: new Date().getTime()
                };
                db.put(config).then((response)=>{
                    if (!response.ok) {
                        console.log('Error saving configuration.', response);
                        return;
                    }
                    _configRevision = response.rev;
                    console.log('Configuration saved.', _configRevision);
                });
            },
            addAdapter: (adapter) => {
                if (adapters.find((a) => a.id() === adapter.id()) != null) {
                    return false;
                }
                adapters.push(adapter);
                if (listener != null) {
                    listener.onAdapterAdded(adapter);
                }
                return true;
            },
            getAdapter: (adapterId, componentId, callback) => {
                let adapter = adapters.find((a) => a.id() === adapterId);
                if (componentId == null && callback == null) return adapter;
                // create a new instance if not found
                if (adapter == null) {
                    zuix.load(componentId, {
                        // this is a controller-only component with no view
                        view: '',
                        // add the adapter to HGUI once it is loaded and ready
                        ready: (ctx) => {
                            _hgui.addAdapter(ctx);
                            callback(ctx);
                        }
                    });
                } else callback(adapter);
            },
            getAdapters: () => adapters,
            getCurrentGroup: () => groups[currentGroup],
            setCurrentGroup: (groupIndex) => {
                currentGroup = groupIndex;
            },
            addGroup: (name) => {
                let group = _hgui.getGroup(name);
                if (group != null) return group;
                group = {};
                group.name = name;
                group.modules = [];
                groups.push(group);
                if (listener != null) {
                    listener.onGroupAdded(group);
                }
                return group;
            },
            addGroupModule: (group, m) => {
                if (group.modules.find((em) => em.moduleId === m.id) != null) {
                    // module already added
                    return false;
                }
                const moduleReference = {
                    moduleId: m.id,
                    adapterId: m.adapterId
                };
                group.modules.push(moduleReference);
                if (listener != null) {
                    listener.onGroupModuleAdded(group, m);
                }
                return true;
            },
            removeGroup: (name) => {
                const group = groups.find((g) => g.name === name);
                if (group != null) {
                    groups = groups.filter((item) => item.name !== name);
                    if (listener != null) {
                        listener.onGroupRemoved(group);
                    }
                    return true;
                }
                return false;
            },
            hasGroup: (name) => {
                return _hgui.getGroup(name) != null;
            },
            getGroup: (name) => {
                return groups.find((item) => item.name === name);
            },
            addModule: (module) => {
                const m = _hgui.getModule(module.id, module.adapterId);
                if (m != null) return m;
                module = zuix.observer().observe(module).proxy;
                modules.push(module);
                if (listener != null) {
                    listener.onModuleAdded(module);
                }
                return module;
            },
            removeModule: (module) => {
                modules = modules.filter((item) => item !== module);
                if (listener != null) {
                    listener.onModuleRemoved(module);
                }
            },
            /**
             * Check if a module exists
             * @param moduleId {string} Module unique identifier
             * @param adapter {string} Adapter identifier
             * @return {boolean}
             */
            hasModule: (moduleId, adapterId) => {
                return _hgui.getModule(moduleId, adapterId) != null;
            },
            /**
             * Get a module
             * @param moduleId {string} Module unique identifier
             * @param adapterId {string} Adapter identifier
             * @return {*}
             */
            getModule: (moduleId, adapterId) => {
                return modules.find((item) => item.id === moduleId && item.adapterId === adapterId);
            },
            getModules: () => modules,
            getModuleField: (module, key) => {
                if (module.fields == null) return null;
                return module.fields.find((f) => f.key === key);
            },
            updateModuleField: (module, key, value, timestamp) => {
                if (module.fields == null) module.fields = [];
                let field = module.fields.find((f) => f.key === key);
                if (field != null && field.timestamp === timestamp) {
                    return;
                } else if (field == null) {
                    field = {key: key};
                    module.fields.push(field);
                }
                field.value = value;
                field.timestamp = timestamp;
            },
            setListener: (l) => listener = l,
            showLoader: (overlay) => {
                if (overlay) splashScreen.css('background', 'rgba(255,255,255,0.25)');
                else splashScreen.css('background', '');
                splashScreen.animateCss('fadeIn').show();
            },
            hideLoader: () => {
                splashScreen.animateCss('fadeOut', () => {
                    splashScreen.hide();
                });
            }
        };
        return _hgui;
    }

    if (typeof(window.hgui) === 'undefined') {
        window.hgui = new HGUI();
    }
})(window);

//{% endraw %}</script>
  <!-- Main page script and components loading options -->
  <script src="index.js" defer=""></script>
  <script>//{% raw %}
'use strict';

let drawerLayout;
let viewPager;
let groupIndicator;

// The 'options' object mainly holds configuration options
// used for loading zuix components and set with the
// 'data-ui-options' element attribute
window.options = {
    drawerLayout: {
        encapsulation: true,
        autoHideWidth: -1,
        drawerWidth: 280,
        ready: (ctx) => {
            drawerLayout = ctx; ctx.close();
        }
    },
    headerBar: {
        encapsulation: true,
        ready: (ctx) => {
            const view = zuix.$(ctx.view());
            // open drawer when the profile icon is clicked
            view.find('.logo').on('click', function() {
                if (drawerLayout) drawerLayout.open();
            });
        }
    },
    viewPager: {
        enablePaging: true,
        startGap: 36,
        on: {
            'page:change': (e, page) => {
                hgui.setCurrentGroup(page.in);
                syncPageIndicator(page);
                // show header/footer
                /*
                if (viewPager) {
                    const p = viewPager.get(page.in);
                    zuix.context(p).show();
                }
                */
                zuix.context('button-menu').showButton();
            }
        },
        ready: (ctx) => {
            viewPager = ctx;
        }
    },
    groupIndicator: {
        enablePaging: true,
        startGap: 36,
        ready: (ctx) => {
            groupIndicator = ctx;
        }
    },
    autoHidingBars: {
        header: 'header-bar',
        footer: 'footer-bar',
        height: 56,
        on: {
            'page:scroll': (e, data) => {
                const menu = zuix.context('button-menu');
                zuix.componentize();
                if (data.info.shift.y < 0) {
                    if (menu.showing()) menu.hideButton();
                } else {
                    if (!menu.showing()) menu.showButton();
                }
            }
        }
    },
    content: {
        css: false
    }
};

//{% endraw %}</script>
  <script src="index.hgui.js" defer=""></script>
  <script>//{% raw %}
// HG commands enum
var CMD = {
    Control: {
        On: 'Control.On',
        Off: 'Control.Off',
        Level: 'Control.Level',
        Toggle: 'Control.Toggle'
    },
    Options: {
        Show: 'Options.Show'
    },
    Programs: {
        Toggle: 'Programs.Toggle'
    }
};
var FLD = {
    Meter: {
        Watts: 'Meter.Watts'
    },
    Sensor: {
        Humidity: 'Sensor.Humidity',
        Luminance: 'Sensor.Luminance',
        Temperature: 'Sensor.Temperature'
    },
    Status: {
        Level: 'Status.Level'
    },
    Program: {
        Status: 'Program.Status',
        Error: 'Program.Error'
    }
};

//{% endraw %}</script>
  <!-- Main page style includes -->
  <style>
/*{% raw %}*/
/* CSS files add styling rules to your content */

body {
    font-size: 16px;
    margin: 0; padding: 0;
    background: white;
    -webkit-user-select:none;
    -moz-user-select:none;
    -ms-user-select:none;
    user-select:none;
    overscroll-behavior-y: contain;
}

.drawer {
    background: white;
}

/*{% endraw %}*/
</style>

    <style>[z-view]:not([z-include]):not([z-load]) { display: none; }</style>
</head>

<body>

<!-- The header with profile icon button for opening the drawer layout (side menu panel) -->
<header data-ui-include="layout/header" data-ui-options="options.headerBar" data-ui-field="header-bar"></header>

<main data-ui-field="pages">

  <!-- HOME -->
  <section data-ui-include="pages/home" data-ui-context="main-page" data-ui-field="main-page"></section>

  <!-- EVENTS & LOGS -->
  <section data-ui-include="pages/eventslog" data-ui-field="logs-page"></section>

  <!-- SETUP WIZARD -->
  <section data-ui-load="pages/setup" class="animated fadeIn" data-ui-field="setup-page"></section>

</main>

<!-- The footer with toolbar buttons -->
<!--
<footer data-ui-include="layout/footer"
        data-ui-options="options.footerBar"
        data-ui-field="footer-bar"></footer>
-->

<div data-ui-load="pages/module_detail" data-ui-context="module-detail" tabindex="0"></div>

<!-- The DrawerLayout for side menu panel -->
<div data-ui-load="@lib/controllers/drawer_layout" data-ui-options="options.drawerLayout" class="drawer" draggable="false">
  <!-- Add Navigation Drawer content -->
  <div data-ui-load="shared/main_menu"></div>
</div>

<!-- FAB -->
<div data-ui-include="shared/button_menu" data-ui-field="footer-bar"></div>

<div data-ui-include="pages/splash" data-ui-field="splash-screen" data-ui-priority="-1" layout="row center-center"></div>
<!--
<div data-ui-load="tools/zuix_hackbox"
     data-ui-context="zhb"
     data-ui-priority="10"></div>
-->
<noscript>
  Turn on JavaScript to access this site content.
</noscript>


    <!-- Google Analytics: change UA-123-456 to be your site's ID -->
    <!--
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-123-456', 'auto');
        ga('send', 'pageview');
    </script>
    -->
    <!-- Built with love using zUIx Web Starter -->

    <!-- app common CSS -->
    <style>
/*{% raw %}*/
body {
    font-size: 14px;
    font-family: "Benton Sans", "Helvetica Neue", helvetica, arial, sans-serif;
}
h1,h2,h3,h4,h5,h6 {
    font-weight: 300;
    font-family: "Benton Sans", "Helvetica Neue", helvetica, arial, sans-serif;
}
h1 {
    font-size: 280%;
}

/* INPUT TEXT AND TEXTAREA */

input[type=text], textarea {
    border-radius: 6px;
    -webkit-transition: all 0.30s ease-in-out;
    -moz-transition: all 0.30s ease-in-out;
    -ms-transition: all 0.30s ease-in-out;
    -o-transition: all 0.30s ease-in-out;
    outline: none;
    padding: 3px 0 3px 3px;
    margin: 5px 1px 3px 0;
    border: 1px solid #DDDDDD;
}

input[type=text]:focus, textarea:focus {
    box-shadow: 0 0 5px rgba(81, 203, 238, 1);
    padding: 3px 0 3px 3px;
    margin: 5px 1px 3px 0;
    border: 1px solid rgba(81, 203, 238, 1);
}

/* LINK */

a,a:hover,a:visited {
    color: palevioletred;
    text-decoration: none;
}

/* LABEL */

label {
    display:inline-block;
    color: #229553;
    text-transform: uppercase;
    padding: 4px; margin-top: 8px;
    font-weight: 800;
}

/* BUTTON */

.hgui-button.color-accent {
    background-color: #229553;
}

.hgui-button {
    position: relative;

    display: block;
    margin: 8px;
    padding: 8px 16px;

    min-width: 48px;
    min-height: 48px;

    overflow: hidden;

    border-width: 0;
    outline: none;
    border-radius: 4px;
    box-shadow: 0 1px 4px rgba(0, 0, 0, .6);

    background-color: rgba(240,240,240,0.8);
    color: black;

    text-transform: uppercase;
    font-size: 90%;
    font-weight: 800;

    transition: background-color .3s;
}

.hgui-button:hover, .hgui-button:focus {
    background-color: rgba(220,220,220,0.8);
}
.hgui-button:focus {
    background-color: rgba(220,220,220,0.8);
    box-shadow: 0 1px 2px rgba(0, 0, 0, .6);
}
.hgui-button:hover.color-accent, .hgui-button:focus.color-accent {
    background-color: #27ae60;
}

.hgui-button > * {
    position: relative;
}

.hgui-button span {
    display: block;
    padding: 12px 24px;
}

.hgui-button:before {
    content: "";

    position: absolute;
    top: 50%;
    left: 50%;

    display: block;
    width: 0;
    padding-top: 0;

    border-radius: 100%;

    background-color: rgba(255, 255, 255, .4);

    -webkit-transform: translate(-50%, -50%);
    -moz-transform: translate(-50%, -50%);
    -ms-transform: translate(-50%, -50%);
    -o-transform: translate(-50%, -50%);
    transform: translate(-50%, -50%);
}

.hgui-button:active:before {
    width: 120%;
    padding-top: 120%;

    transition: width .2s ease-out, padding-top .2s ease-out;
}

/* CHECKBOX */

/* The container */
.hgui-checkbox {
    display: block;
    position: relative;
    padding-left: 35px;
    margin-top: 8px;
    margin-bottom: 8px;
    padding-top: 8px;
    cursor: pointer;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
}

/* Hide the browser's default checkbox */
.hgui-checkbox input {
    position: absolute;
    opacity: 0;
    cursor: pointer;
    height: 0;
    width: 0;
}

/* Create a custom checkbox */
.checkmark {
    position: absolute;
    top: 0;
    left: 0;
    height: 24px;
    width: 24px;
    background-color: #eee;
}

/* On mouse-over, add a grey background color */
.hgui-checkbox:hover input ~ .checkmark {
    background-color: #ccc;
}

/* When the checkbox is checked, add a blue background */
.hgui-checkbox input:checked ~ .checkmark {
    background-color: #229553;
}

/* Create the checkmark/indicator (hidden when not checked) */
.checkmark:after {
    content: "";
    position: absolute;
    display: none;
}

/* Show the checkmark when checked */
.hgui-checkbox input:checked ~ .checkmark:after {
    display: block;
}

/* Style the checkmark/indicator */
.hgui-checkbox .checkmark:after {
    left: 10px;
    top: 5px;
    width: 5px;
    height: 12px;
    border: solid white;
    border-width: 0 3px 3px 0;
    -webkit-transform: rotate(45deg);
    -ms-transform: rotate(45deg);
    transform: rotate(45deg);
}

/* MISC */

.hidden {
    display: none;
}
.clickable {
    cursor: pointer;
}

/*{% endraw %}*/
</style>
    <style>
/*{% raw %}*/
/* Text styles */

.text-bold {
  font-weight: bold;
}
.text-title {
  font-size: 120%;
}
.text-light {
  opacity: 0.5;
}
.text-caption {
  font-size: 80%;
}

/*{% endraw %}*/
</style>
    <style>
/*{% raw %}*/

/* Containers layout */

.container-small {
  min-width: 280px;
  max-width: 300px;
}

.container-height-80 {
  min-width: 280px;
  height: 80px;
}
.container-maxWidth-560 {
  max-width: 560px;
}
.container-height-160 {
  min-height: 160px;
  opacity: 0;
}
.scrollable {
  padding-bottom: 20px;
  overflow-y: scroll;
}
.padding-small {
  padding: 8px;
}
.padding-medium {
  padding: 16px;
}
.padding-large {
  padding: 24px;
}
.delay-100 {
  -webkit-animation-delay: 100ms;
  -moz-animation-delay: 100ms;
  animation-delay: 100ms;
}
.delay-150 {
  -webkit-animation-delay: 150ms;
  -moz-animation-delay: 150ms;
  animation-delay: 150ms;
}
.delay-200 {
  -webkit-animation-delay: 200ms;
  -moz-animation-delay: 200ms;
  animation-delay: 200ms;
}
.delay-250 {
  -webkit-animation-delay: 250ms;
  -moz-animation-delay: 250ms;
  animation-delay: 250ms;
}
.delay-400 {
  -webkit-animation-delay: 400ms;
  -moz-animation-delay: 400ms;
  animation-delay: 400ms;
}

/*{% endraw %}*/
</style>





<!-- zUIx inline resource resourceBundle --></body></html>